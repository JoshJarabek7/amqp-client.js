# amqp-client.js

AMQP 0-9-1 client both for Node.js and browsers (using WebSocket)

## Install

```shell
npm install @cloudamqp/amqp-client --save
```

## Example usage

Using AMQP in Node.js:

```javascript
import AMQPClient from 'amqp-client'

async function run() {
  try {
    const amqp = new AMQPClient("amqp://localhost")
    const conn = await amqp.connect()
    const ch = await conn.channel()
    const q = await ch.queue()
    const consumer = await q.subscribe({noAck: true}, async (msg) => {
      console.log(msg.bodyString())
      await consumer.cancel()
    })
    await q.publish("Hello World")
    await consumer.wait() // will block until consumer is cancled or throw an error if server closed channel/connection
    await conn.close()
  } catch (e) {
    console.error("ERROR", e)
    e.connection.close()
    setTimeout(run, 1000) // will try to reconnect in 1s
  }
}

run()
```

Using AMQP over WebSockets in a browser:

```html
<!DOCTYPE html>
<html>
  <head>
    <script type=module>
      import AMQPClient from './js/amqp-websocket-client.mjs'

      const textarea = document.getElementById("textarea")
      const input = document.getElementById("message")

      const tls = window.location.scheme === "https:"
      const url = `${tls ? "wss" : "ws"}://${window.location.host}`
      const amqp = new AMQPClient(url, "/", "guest", "guest")

      async function start() {
        try {
          const conn = await amqp.connect()
          const ch = await conn.channel()
          attachPublish(ch)
          const q = await ch.queue("")
          await q.bind("amq.fanout")
          const consumer = await q.subscribe({noAck: false}, (msg) => {
            console.log(msg)
            textarea.value += msg.bodyString() + "\n"
            msg.ack()
          })
        } catch (err) {
          console.error("Error", err, "reconnecting in 1s")
          setTimeout(start, 1000)
        }
      }

      function attachPublish(ch) {
        document.forms[0].onsubmit = async (e) => {
          e.preventDefault()
          try {
            await ch.basicPublish("amq.fanout", "", input.value, { contentType: "text/plain" })
          } catch (err) {
            console.error("Error", err, "reconnecting in 1s")
            setTimeout(start, 1000)
          }
          input.value = ""
        }
      }

      start()
    </script>
  </head>
  <body>
    <form>
      <textarea id="textarea" rows=10></textarea>
      <br/>
      <input id="message"/>
      <button type="submit">Send</button>
    </form>
  </body>
</html>
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [AMQPBaseClient](#amqpbaseclient)
    -   [Parameters](#parameters)
    -   [channel](#channel)
        -   [Parameters](#parameters-1)
    -   [close](#close)
        -   [Parameters](#parameters-2)
-   [AMQPChannel](#amqpchannel)
    -   [Parameters](#parameters-3)
    -   [queue](#queue)
        -   [Parameters](#parameters-4)
    -   [prefetch](#prefetch)
        -   [Parameters](#parameters-5)
    -   [onReturn](#onreturn)
        -   [Parameters](#parameters-6)
    -   [close](#close-1)
        -   [Parameters](#parameters-7)
    -   [basicGet](#basicget)
        -   [Parameters](#parameters-8)
    -   [basicConsume](#basicconsume)
        -   [Parameters](#parameters-9)
    -   [basicCancel](#basiccancel)
        -   [Parameters](#parameters-10)
    -   [basicAck](#basicack)
        -   [Parameters](#parameters-11)
    -   [basicNack](#basicnack)
        -   [Parameters](#parameters-12)
    -   [basicReject](#basicreject)
        -   [Parameters](#parameters-13)
    -   [basicRecover](#basicrecover)
        -   [Parameters](#parameters-14)
    -   [basicPublish](#basicpublish)
        -   [Parameters](#parameters-15)
    -   [basicQos](#basicqos)
        -   [Parameters](#parameters-16)
    -   [basicFlow](#basicflow)
        -   [Parameters](#parameters-17)
    -   [confirmSelect](#confirmselect)
    -   [queueDeclare](#queuedeclare)
        -   [Parameters](#parameters-18)
    -   [queueDelete](#queuedelete)
        -   [Parameters](#parameters-19)
    -   [queueBind](#queuebind)
        -   [Parameters](#parameters-20)
    -   [queueUnbind](#queueunbind)
        -   [Parameters](#parameters-21)
    -   [queuePurge](#queuepurge)
        -   [Parameters](#parameters-22)
    -   [exchangeDeclare](#exchangedeclare)
        -   [Parameters](#parameters-23)
    -   [exchangeDelete](#exchangedelete)
        -   [Parameters](#parameters-24)
    -   [exchangeBind](#exchangebind)
        -   [Parameters](#parameters-25)
    -   [exchangeUnbind](#exchangeunbind)
        -   [Parameters](#parameters-26)
    -   [txSelect](#txselect)
    -   [txCommit](#txcommit)
    -   [txRollback](#txrollback)
-   [AMQPConsumer](#amqpconsumer)
    -   [Parameters](#parameters-27)
    -   [wait](#wait)
        -   [Parameters](#parameters-28)
    -   [cancel](#cancel)
-   [AMQPError](#amqperror)
    -   [Parameters](#parameters-29)
    -   [Properties](#properties)
-   [AMQPMessage](#amqpmessage)
    -   [Parameters](#parameters-30)
    -   [Properties](#properties-1)
    -   [bodyToString](#bodytostring)
    -   [ack](#ack)
        -   [Parameters](#parameters-31)
    -   [nack](#nack)
        -   [Parameters](#parameters-32)
    -   [reject](#reject)
        -   [Parameters](#parameters-33)
-   [AMQPQueue](#amqpqueue)
    -   [Parameters](#parameters-34)
    -   [bind](#bind)
        -   [Parameters](#parameters-35)
    -   [unbind](#unbind)
        -   [Parameters](#parameters-36)
    -   [subscribe](#subscribe)
        -   [Parameters](#parameters-37)
-   [AMQPClient](#amqpclient)
    -   [Parameters](#parameters-38)
    -   [connect](#connect)
-   [AMQPWebSocketClient](#amqpwebsocketclient)
    -   [Parameters](#parameters-39)
    -   [connect](#connect-1)

### AMQPBaseClient

Base class for AMQPClients.
Implements everything except how to connect, send data and close the socket

#### Parameters

-   `vhost` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `username` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `password` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the connection, set in client properties
-   `platform` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** used in client properties

#### channel

Open a channel
Optionally an existing or non existing channel id can be specified
return {Promise&lt;AMQPChannel, AMQPError>} channel

##### Parameters

-   `id`  

#### close

Gracefully close the AMQP connection

##### Parameters

-   `params` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `params.code` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Close code (optional, default `200`)
    -   `params.reason` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Reason for closing the connection (optional, default `""`)

### AMQPChannel

Represents an AMQP Channel. Almost all actions in AMQP are performed on a Channel.

#### Parameters

-   `connection` **[AMQPBaseClient](#amqpbaseclient)** The connection this channel belongs to
-   `id` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** ID of the channel

#### queue

Declare a queue and return a AMQPQueue object.

##### Parameters

-   `name`   (optional, default `""`)
-   `props`   (optional, default `{}`)
-   `args`   (optional, default `{}`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[AMQPQueue](#amqpqueue), [AMQPError](#amqperror)>** Convient wrapper around a Queue object

#### prefetch

Alias for basicQos

##### Parameters

-   `prefetchCount`  

#### onReturn

Default handler for Returned messages

##### Parameters

-   `message` **[AMQPMessage](#amqpmessage)** 

#### close

Close the channel gracefully

##### Parameters

-   `params` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `params.code` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** Close code (optional, default `200`)
    -   `params.reason` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Reason for closing the channel (optional, default `""`)

#### basicGet

Synchronously receive a message from a queue

##### Parameters

-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue to poll
-   `param` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `param.noAck` **bool** if message is removed from the server upon delivery, or have to be acknowledged (optional, default `true`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;([AMQPMessage](#amqpmessage) | null), [AMQPError](#amqperror)>** returns null if the queue is empty otherwise a single message

#### basicConsume

Consume from a queue. Messages will be delivered asynchronously.

##### Parameters

-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue to poll
-   `param` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `param.tag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** tag of the consumer, will be server generated if left empty (optional, default `""`)
    -   `param.noAck` **bool** if messages are removed from the server upon delivery, or have to be acknowledged (optional, default `true`)
    -   `param.exclusive` **bool** if this can be the only consumer of the queue, will return an Error if there are other consumers to the queue already (optional, default `false`)
    -   `param.args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** custom arguments (optional, default `{}`)
-   `callback` **function (message: [AMQPMessage](#amqpmessage))** will be called for each message delivered to this consumer

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[AMQPConsumer](#amqpconsumer), [AMQPError](#amqperror)>** 

#### basicCancel

Cancel/stop a consumer

##### Parameters

-   `tag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** consumer tag

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[AMQPChannel](#amqpchannel), [AMQPError](#amqperror)>** 

#### basicAck

Acknowledge a delivered message

##### Parameters

-   `deliveryTag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** tag of the message
-   `multiple` **bool** batch confirm all messages up to this delivery tag (optional, default `false`)

#### basicNack

Acknowledge a delivered message

##### Parameters

-   `deliveryTag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** tag of the message
-   `requeue` **bool** if the message should be requeued or removed (optional, default `false`)
-   `multiple` **bool** batch confirm all messages up to this delivery tag (optional, default `false`)

#### basicReject

Acknowledge a delivered message

##### Parameters

-   `deliveryTag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** tag of the message
-   `requeue` **bool** if the message should be requeued or removed (optional, default `false`)

#### basicRecover

Tell the server to redeliver all unacknowledged messages again, or reject and requeue them.

##### Parameters

-   `requeue` **bool** if the message should be requeued or redeliviered to this channel (optional, default `false`)

#### basicPublish

Publish a message

##### Parameters

-   `exchange` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** the exchange to publish to, the exchange must exists
-   `routingKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** routing key
-   `data` **([string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String) \| [uint8array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array))** the data to be published, can be a string or an uint8array
-   `properties` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** publish properties
-   `mandatory` **bool?** if the message should be returned if there's no queue to be delivered to
-   `immediate` **bool?** if the message should be returned if it can't be delivered to a consumer immediately (not supported in RabbitMQ)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), [AMQPError](#amqperror)>** fulfilled when the message is enqueue on the socket, or if publish confirm is enabled when the message is confirmed by the server

#### basicQos

Set prefetch limit.
Recommended to set as each unacknowledge message will be store in memory of the client.
The server won't deliver more messages than the limit until messages are acknowledged.

##### Parameters

-   `prefetchCount` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of messages to limit to
-   `prefetchSize` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)** number of bytes to limit to (not supported by RabbitMQ) (optional, default `0`)
-   `global` **bool** if the prefetch is limited to the channel, or if false to each consumer (optional, default `false`)

#### basicFlow

Enable or disable flow. Disabling flow will stop the server from delivering messages to consumers.
Not supported in RabbitMQ

##### Parameters

-   `active` **bool**  (optional, default `true`)

#### confirmSelect

Enable publish confirm. The server will then confirm each publish with an Ack or Nack when the message is enqueued.

#### queueDeclare

Declare a queue

##### Parameters

-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue, if empty the server will generate a name (optional, default `""`)
-   `params` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `params.passive` **bool** if the queue name doesn't exists the channel will be closed with an error, fulfilled if the queue name does exists (optional, default `false`)
    -   `params.durable` **bool** if the queue should survive server restarts (optional, default `name!==""`)
    -   `params.autoDelete` **bool** if the queue should be deleted when the last consumer of the queue disconnects (optional, default `name===""`)
    -   `params.exclusive` **bool** if the queue should be deleted when the channel is closed (optional, default `name===""`)
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** optional custom queue arguments (optional, default `{}`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;{queueName: [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String), messages: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number), consumers: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)}, [AMQPError](#amqperror)>** fulfilled when confirmed by the server

#### queueDelete

Delete a queue

##### Parameters

-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue, if empty it will delete the last declared queue (optional, default `""`)
-   `params` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `params.ifUnused` **bool** only delete if the queue doesn't have any consumers (optional, default `false`)
    -   `params.ifEmpty` **bool** only delete if the queue is empty (optional, default `false`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;{messageCount: [number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)}, [AMQPError](#amqperror)>** 

#### queueBind

Bind a queue to an exchange

##### Parameters

-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue
-   `exchange` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the exchange
-   `routingKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** key to bind with
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** optional arguments, e.g. for header exchanges (optional, default `{}`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** fulfilled when confirmed by the server

#### queueUnbind

Unbind a queue from an exchange

##### Parameters

-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue
-   `exchange` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the exchange
-   `routingKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** key that was bound
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** arguments, e.g. for header exchanges (optional, default `{}`)

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** fulfilled when confirmed by the server

#### queuePurge

Purge a queue

##### Parameters

-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** fulfilled when confirmed by the server

#### exchangeDeclare

Declare an exchange

##### Parameters

-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the exchange
-   `type` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** type of exchange (direct, fanout, topic, header, or a custom type)
-   `param` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `param.passive` **bool** if the exchange name doesn't exists the channel will be closed with an error, fulfilled if the exchange name does exists (optional, default `false`)
    -   `param.durable` **bool** if the exchange should survive server restarts (optional, default `true`)
    -   `param.autoDelete` **bool** if the exchange should be deleted when the last binding from it is deleted (optional, default `false`)
    -   `param.internal` **bool** if exchange is internal to the server. Client's can't publish to internal exchanges. (optional, default `false`)
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** optional arguments (optional, default `{}`)

#### exchangeDelete

Delete an exchange

##### Parameters

-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the exchange
-   `param` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `param.ifUnused` **bool** only delete if the exchange doesn't have any bindings (optional, default `false`)

#### exchangeBind

Exchange to exchange binding.

##### Parameters

-   `destination` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the destination exchange
-   `source`  
-   `routingKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** key to bind with (optional, default `""`)
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** optional arguments, e.g. for header exchanges (optional, default `{}`)
-   `exchange` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the source exchange

#### exchangeUnbind

Delete an exchange-to-exchange binding

##### Parameters

-   `destination`  
-   `source`  
-   `routingKey` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** key that was bound (optional, default `""`)
-   `args` **[object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** arguments, e.g. for header exchanges (optional, default `{}`)
-   `queue` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue
-   `exchange` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the exchange

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** fulfilled when confirmed by the server

#### txSelect

Set this channel in Transaction mode.
Rember to commit the transaction, overwise the server will eventually run out of memory.

#### txCommit

Commit a transaction

#### txRollback

Rollback a transaction

### AMQPConsumer

A consumer, subscribed to a queue

#### Parameters

-   `channel` **[AMQPChannel](#amqpchannel)** the consumer is created on
-   `tag` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** consumer tag
-   `onMessage` **function (message: [AMQPMessage](#amqpmessage))** callback executed when a message arrive

#### wait

Wait for the consumer to finish.

##### Parameters

-   `timeout` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)?** wait for this many milliseconds and then return regardless

#### cancel

Cancel/abort/stop the consumer. No more messages will be deliviered to the consumer.
Note that any unacked messages are still unacked as they belong to the channel and not the consumer.

### AMQPError

**Extends Error**

An error, can be both AMQP level errors or socket errors

#### Parameters

-   `message` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `connection` **[AMQPBaseClient](#amqpbaseclient)** The connection the error was raised on

#### Properties

-   `message` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `connection` **[AMQPBaseClient](#amqpbaseclient)** The connection the error was raised on

### AMQPMessage

AMQP message

#### Parameters

-   `channel` **[AMQPChannel](#amqpchannel)** Channel this message was delivered on

#### Properties

-   `body` **[Uint8array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** The raw message body
-   `deliveryTag` **[Uint8array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)** The deliveryTag of this message

#### bodyToString

Converts the message (which is deliviered as an uint8array) to a string

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** utf8 encoded string

#### ack

Acknowledge the message

##### Parameters

-   `multiple`   (optional, default `false`)

#### nack

Negative acknowledgment (same as reject)

##### Parameters

-   `requeue`   (optional, default `false`)
-   `multiple`   (optional, default `false`)

#### reject

Rejected the message

##### Parameters

-   `requeue`   (optional, default `false`)

### AMQPQueue

Convience class for queues

#### Parameters

-   `channel` **[AMQPChannel](#amqpchannel)** channel this queue was declared on
-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** name of the queue

#### bind

Bind the queue to an exchange

##### Parameters

-   `exchange`  
-   `routingkey`  
-   `args`   (optional, default `{}`)

#### unbind

Delete a binding between this queue and an exchange

##### Parameters

-   `exchange`  
-   `routingkey`  
-   `args`   (optional, default `{}`)

#### subscribe

##### Parameters

-   `$0` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)
    -   `$0.noAck`   (optional, default `true`)
    -   `$0.exclusive`   (optional, default `false`)
-   `callback`  

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)&lt;[AMQPConsumer](#amqpconsumer), [AMQPError](#amqperror)>** 

### AMQPClient

**Extends AMQPBaseClient**

AMQP 0-9-1 client over TCP socket.

#### Parameters

-   `url` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** uri to the server, example: amqp://user:passwd@localhost:5672/vhost

#### connect

Try establish a connection

### AMQPWebSocketClient

**Extends AMQPBaseClient**

WebSocket client for AMQP 0-9-1 servers

#### Parameters

-   `url` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** to the websocket endpoint
-   `vhost` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** , default '/' (optional, default `"/"`)
-   `username` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** , default 'guest' (optional, default `"guest"`)
-   `password` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** , default 'guest' (optional, default `"guest"`)
-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** of the connection, no default (optional, default `undefined`)

#### connect

Establish a AMQP connection over WebSocket

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** Promise to returns itself when successfully connected
